# This file contains the configuration for the VSC7224 retimer on an APd1.
# The format to write a register is "page:register=value".
# You may define constants (which can be used in place of a field, register, or value) with "set NAME=value"


# Page addresses
set SYNTH0=0x0030
set CHAN0=0x0000
set CHAN1=0x0001
set CHAN2=0x0002
set CHAN3=0x0003
set VSCOPEBCAST=0x0060
set STATUS=0x0040

# this version of the retimer starts with the 10.0G script that works and minimally adjusts the synths and other settings
# for 10.260G operation

# desired configuration:
# 10.0G, channels 0/1, using fsynth0
# auto adaptation enabled for equalizer and gain amplifier
# auto rate select disabled
# auto adaption for DFE and equalizer on by default
# vscope powered down

# set up core register values
STATUS:0x80=0xCC00
STATUS:0x81=0x4000
STATUS:0x82=0x7800
STATUS:0x83=0x0000
STATUS:0x84=0x0020
STATUS:0x85=0x0000
STATUS:0x86=0x0000

# set up synthesizers
SYNTH0:0x80=0x2F4C
SYNTH0:0x81=0x0008
SYNTH0:0x82=0xC6C0
SYNTH0:0x83=0x000F
SYNTH0:0x84=0xDE15
SYNTH0:0x85=0x0000
SYNTH0:0x86=0x0000
# (leave fsynth 1 in reset default powered-down state)


# Set up Input Register Values
#
# RX device (using channel broadcast page address)
# channel 0:
CHAN0:0x80=0x2211
CHAN0:0x81=0x117f
CHAN0:0x82=0x0021
CHAN0:0x83=0x0021
CHAN0:0x84=0x0800
CHAN0:0x85=0x0000
CHAN0:0x86=0x3000
CHAN0:0x87=0x0021
CHAN0:0x88=0x01AA
CHAN0:0x89=0x7F15
CHAN0:0xAC=0x01AA
CHAN0:0xAD=0x0021
CHAN0:0xAE=0x3006
CHAN0:0xAF=0x3006
CHAN0:0xA8=0x2400
CHAN0:0xA9=0x0060
CHAN0:0xA7=0x0000
CHAN0:0xC0=0x0000
CHAN0:0xC1=0x0000
CHAN0:0xC2=0x0000
CHAN0:0xC3=0x0000
CHAN0:0xC4=0x0000
CHAN0:0xC5=0x0000
CHAN0:0xC6=0x0000
CHAN0:0xC7=0x0000
CHAN0:0xC8=0x0000
CHAN0:0xE5=0x0000
CHAN0:0xE6=0x0000
CHAN0:0xE7=0x0000
CHAN0:0xE8=0x0000
# channel 1:
CHAN1:0x80=0x2211
CHAN1:0x81=0x117f
CHAN1:0x82=0x0021
CHAN1:0x83=0x0021
CHAN1:0x84=0x0800
CHAN1:0x85=0x0000
CHAN1:0x86=0x3000
CHAN1:0x87=0x0021
CHAN1:0x88=0x01AA
CHAN1:0x89=0x7F15
CHAN1:0xAC=0x01AA
CHAN1:0xAD=0x0021
CHAN1:0xAE=0x3006
CHAN1:0xAF=0x3006
CHAN1:0xA8=0x2400
CHAN1:0xA9=0x0060
CHAN1:0xA7=0x0000
CHAN1:0xC0=0x0000
CHAN1:0xC1=0x0000
CHAN1:0xC2=0x0000
CHAN1:0xC3=0x0000
CHAN1:0xC4=0x0000
CHAN1:0xC5=0x0000
CHAN1:0xC6=0x0000
CHAN1:0xC7=0x0000
CHAN1:0xC8=0x0000
CHAN1:0xE5=0x0000
CHAN1:0xE6=0x0000
CHAN1:0xE7=0x0000
CHAN1:0xE8=0x0000

#
# Set up DFECRU Register Values
#
# channel 0:
CHAN0:0x8A=0x7000
CHAN0:0x8B=0x4060
CHAN0:0x8C=0x0000
CHAN0:0x8D=0x0000
CHAN0:0x8E=0x0000
CHAN0:0x8F=0x00FF
CHAN0:0x90=0xDE85
CHAN0:0x91=0x2020
CHAN0:0x92=0x0860
CHAN0:0x93=0x6000
CHAN0:0x94=0x0001
CHAN0:0x95=0x0008
CHAN0:0x96=0x0000
CHAN0:0xAA=0x0888
CHAN0:0xAB=0x0000
CHAN0:0xC9=0x0000
CHAN0:0xCA=0x0000
CHAN0:0xCB=0x0000
CHAN0:0xCC=0x0000
CHAN0:0xCD=0x0000
CHAN0:0xCE=0x0000
CHAN0:0xE9=0x0000
CHAN0:0xEA=0x0000
CHAN0:0xEB=0x0000
CHAN0:0xEC=0x0000
# channel 1:
CHAN1:0x8A=0x7000
CHAN1:0x8B=0x4060
CHAN1:0x8C=0x0000
CHAN1:0x8D=0x0000
CHAN1:0x8E=0x0000
CHAN1:0x8F=0x00FF
CHAN1:0x90=0xDE85
CHAN1:0x91=0x2020
CHAN1:0x92=0x0860
CHAN1:0x93=0x6000
CHAN1:0x94=0x0001
CHAN1:0x95=0x0008
CHAN1:0x96=0x0000
CHAN1:0xAA=0x0888
CHAN1:0xAB=0x0000
CHAN1:0xC9=0x0000
CHAN1:0xCA=0x0000
CHAN1:0xCB=0x0000
CHAN1:0xCC=0x0000
CHAN1:0xCD=0x0000
CHAN1:0xCE=0x0000
CHAN1:0xE9=0x0000
CHAN1:0xEA=0x0000
CHAN1:0xEB=0x0000
CHAN1:0xEC=0x0000


#
# Adaption Register Values
#
# RX device (using channel broadcast page address)
# channel 0:
CHAN0:0xA5=0x0000
CHAN0:0xA6=0x0000
# channel 1:
CHAN1:0xA5=0x0000
CHAN1:0xA6=0x0000

#
# Output Register Values
#
# RX device (using channel broadcast page address)
# channel 0:
CHAN0:0x97=0x0000
CHAN0:0x98=0x0000
CHAN0:0x99=0x001E
CHAN0:0x9A=0x000E
CHAN0:0x9B=0x0005
CHAN0:0x9C=0x0000
CHAN0:0x9D=0x0001
CHAN0:0xCF=0x0000
CHAN0:0xD0=0x0000
CHAN0:0xD1=0x0000
CHAN0:0xD2=0x0000
CHAN0:0xD3=0x0000
CHAN0:0xD4=0x0000
CHAN0:0xD5=0x0000
CHAN0:0xD6=0x0000
CHAN0:0xD7=0x0000
CHAN0:0xD8=0x0000
CHAN0:0xD9=0x0000
CHAN0:0xDA=0x0000
# channel 1:
#note:  channel 1 output polarity inverted per schematic
CHAN1:0x97=0x4000
CHAN1:0x98=0x0000
CHAN1:0x99=0x001E
CHAN1:0x9A=0x000E
CHAN1:0x9B=0x0005
CHAN1:0x9C=0x0000
CHAN1:0x9D=0x0001
CHAN1:0xCF=0x0000
CHAN1:0xD0=0x0000
CHAN1:0xD1=0x0000
CHAN1:0xD2=0x0000
CHAN1:0xD3=0x0000
CHAN1:0xD4=0x0000
CHAN1:0xD5=0x0000
CHAN1:0xD6=0x0000
CHAN1:0xD7=0x0000
CHAN1:0xD8=0x0000
CHAN1:0xD9=0x0000
CHAN1:0xDA=0x0000

#
# LOS Registers
#
# RX device (using channel broadcast page address)
# channel 0:
CHAN0:0x9E=0x03E8
CHAN0:0x9F=0x04EA
CHAN0:0xA0=0x0000
CHAN0:0xA1=0x0000
CHAN0:0xA2=0x0000
CHAN0:0xA3=0x0000
CHAN0:0xA4=0x0000
# channel 1:
CHAN1:0x9E=0x03E8
CHAN1:0x9F=0x04EA
CHAN1:0xA0=0x0000
CHAN1:0xA1=0x0000
CHAN1:0xA2=0x0000
CHAN1:0xA3=0x0000
CHAN1:0xA4=0x0000

# powering down channels 2 and 3
CHAN2:0xA4=0x8000
CHAN3:0xA4=0x8000

#
# VSCOPE control (powered down)
#
VSCOPEBCAST:0x83=0x0001

# end of script
